<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Labbing with D3 and moduling">
  <meta name="author" content="Niklas Ek">

  <title>D3 Graphing</title>
  <link rel="stylesheet" href="style.css">

</head>
<body>
  <div id="monastery">
    <h1>En graph!</h1>
    <button id="toggleStacked">Toggle Stacked</button>
    <div id="graphs"></div>
  </div>

  <!--<script src="http://d3js.org/d3.v3.min.js"></script>-->
  <script src="d3.v3.min.js"></script>
  <script src="wisdom/Graphest.js"></script>
  <script>

  /*

    Graphest

  */




  var bla = (function(){
    var i = -1;
    return function(){
      i += 1;
      return i;
      //return new Date().getTime() + i;
    };
  })();

  

  var genData = function(series, points){
    if(!series) var series = 1;
    if(!points) var points = 10;

    var dataset = [];
    var newX, newY, i, j;

    for(i=0; i<points; i++){
      newX = bla();
      for(j=0; j<series; j++){
        oldY = 0;
        if(!dataset[j]) dataset.push([]);
        if(dataset[j][i-1]) oldY = dataset[j][i-1].y;


        newY = oldY + Math.round(Math.random()*20)-10;
        newY = newY > 100 ? 100 : newY;
        newY = newY < 0 ? 0 : newY;

        dataset[j][i] = {x: newX, y:  newY};

      }
    }

    return dataset;
  }

  var graphData = genData(100, 100);



  var graph = new Wisdom.Graphest({
    data: graphData,
    wrapper: "#graphs",
    area: true,
    stacked: true,
    colorClass: ["forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue","forest", "red", "blue"]
  });



  var toggleStacked = document.querySelector('#toggleStacked');

  toggleStacked.addEventListener('click', function(){
    graph.toggleStacked();
  });

  </script>
</body>
</html>